## UI渲染需求概述
   1. 渲染Sprite  
   基础Sprite渲染,SlicedSprite,FilledSprite,Tiled Sprite
   2. 渲染文字  
   需要有高质量文本渲染支持:亚像素渲染
   3. Sprite的贴图管理  
     需要一种比手动图集更方便的散图合并方式
   4. Sprite合批问题  
    区分动态静态问题，配合自动图集功能自动智能合拼。


### 一些实现方案设想
  1. 解决自动合批问题方案  
    a. Panel为最基础的渲染载体，所有Sprite只是描述数据添加和移除必须把自己注册到Panel  
    b. Panel会有父子层级,并且有动态静态标识  
    c.  如果一个Panel是静态Panel会把自己合并到父Panel里。    
        如果一个Panel是动态Panel那么他就是最顶层的渲染元素了。    
        如果一个Panel下面的子Panel有的是动态的有的是静态的，考虑半透问题必须顺序绘制。如果静态Panel中间有动态Panel将会打断向上合并(或许可以做的更细)。  
       理想情况下如果全是静态Panel全局可能只有一个Drawcall，动态元素越多越和静态物体交叉显示被打断的合并就越多。可能会有更好的优化方式处理动态物体，第一版先不考虑。  
   d. 考虑在更上层的UI框架层提供一些语义化的控件自动设置动态还是静态，例如Button就肯定是动态的。而PanelTitle之类的就可能是静态的。

  2. 解决自动贴图管理问题  
   a. Sprite图片完全使用散图，不进行任何目录约束要求。  
   b. 使用TextureArray模拟内存分页的类似概念，加载贴图等于申请内存，释放贴图等于释放内存。  
   c. 通过TextureArray保证不用切换贴图，从而不用切换材质。从而支持任何Sprite可以合并Mesh (用来支持自动合批，但是Sprite除了Mesh数据必须多带上一个贴图在Array里的索引).  
   d. 高频加载散图可能比较耗费IO可以考虑用预加载缓解一下。  

 3. 文字渲染问题  
  a. 考虑文字渲染问题必须考虑一个前提：文字是否可以和Sprite一起合批。  
  如果文字无法和Sprite一起合批并且文字还有可能是半透明的，那么文字UI里面的文字是非常常见的元素，必然非常频繁的打断Sprite的合批。那么就必须使用<b>文字不能是半透明</b>，或者文字总是在最上之类的强制要求。来缓解这个问题。  
  b. 阻碍文字和Sprite合批的另一个大问题是亚像素渲染要用到特殊的shader，和普通Sprite渲染shader是完全不同的。

